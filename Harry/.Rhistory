knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
)
library(tidyverse)
library(ExPanDaR)      # explore panel data interactively
# Change the presentation of decimal numbers to 4 and avoid scientific notation
options(prompt="R> ", digits=3, scipen=999)
library(readxl)
moran <- read_excel("D:/phd2023-harry-aginta-regional-inflation-indonesia/price convergence clubs/data/raw data/Regional inflation and convergence clubs Indonesia_2012 to 2019.xlsx",
sheet = "morans'i")
moran
library(readxl)
moran <- read_excel("D:/phd2023-harry-aginta-regional-inflation-indonesia/price convergence clubs/data/raw data/Regional inflation and convergence clubs Indonesia_2012 to 2019.xlsx",
sheet = "morans'i")
moran
morplot <- ggplot(moran, aes(x=Year, y=Moran))
morplot <- ggplot(moran, aes(x=Year, y=Moran))
morplot
morplot <- ggplot(moran, aes(x=Year, y=Moran), geomline())
morplot
morplot <- ggplot(moran, aes(x=Year, y=Moran), geom_line())
morplot
morplot <- ggplot(moran, aes(x=Year, y=Moran), geom_line()+geom_point())
morplot
library(ggplot2)
morplot <- ggplot(moran, aes(x=Year, y=Moran), geom_line()+geom_point())
morplot
library(ggplot2)
morplot <- ggplot(moran, aes(x=Year, y=Moran), geom_line()+geom_point())
morplot
morplot <- ggplot(moran, aes(x=Year, y=Moran)) + geom_line()+geom_point()
morplot
morplot <- ggplot(moran, aes(x=Year, y=Moran)) + geom_smooth()+geom_point()
morplot
morplot <- ggplot(moran, aes(x=Year, y=Moran)) + geom_line()+geom_point()
morplot
morplot <- ggplot(moran, aes(x=Year, y=Moran, color = blue)) + geom_line()+geom_point()
morplot
morplot <- ggplot(moran, aes(x=Year, y=Moran, color = "blue")) + geom_line()+geom_point()
morplot
morplot <- ggplot(moran, aes(x=Year, y=Moran)) + geom_line()+geom_point()
morplot
morplot <- ggplot(moran, aes(x=Year, y=Moran)) + geom_line()+geom_point() + labs(subtitle = "Consumer Price Index at Province Level, 2012-2019",
x = "Time",
y = "CPI", color="") + theme_bw()
morplot
morplot <- ggplot(moran, aes(x=Year, y=Moran)) + geom_line()+geom_point() + labs(subtitle = "Indonesian Regional Inflation Spatial Autocorrelation, 2012-2019",
x = "Time",
y = "Morans'I", color="blue") + theme_bw()
morplot
morplot <- ggplot(moran, aes(x=Year, y=Moran)) + geom_line(color="blue")+geom_point() + labs(subtitle = "Indonesian Regional Inflation Spatial Autocorrelation, 2012-2019",
x = "Time",
y = "Morans'I") + theme_bw()
morplot
morplot <- ggplot(moran, aes(x=Year, y=Moran)) + geom_line(color="blue")+geom_point(color="red") + labs(subtitle = "Indonesian Regional Inflation Spatial Autocorrelation, 2012-2019",
x = "Time",
y = "Morans'I") + theme_bw()
morplot
morplot <- ggplot(moran, aes(x=Year, y=Moran)) + geom_line(color="dark blue")+geom_point(color="red") + labs(subtitle = "Indonesian Regional Inflation Spatial Autocorrelation, 2012-2019",
x = "Time",
y = "Morans'I") + theme_bw()
morplot
morplot <- ggplot(moran, aes(x=Year, y=Moran)) + geom_line(color="dark blue")+geom_point(color="red") + labs(subtitle = "Indonesian Regional Inflation Spatial Autocorrelation, 2012-2019",
x = "Time",
y = "Morans'I") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
morplot
morplot <- ggplot(moran, aes(x=Year, y=Moran)) + geom_line(color="dark blue")+geom_point(color="red") + labs(subtitle = "Indonesian Regional Inflation Spatial Autocorrelation, 2012-2019",
x = "Time",
y = "Moran's I") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
morplot
morplot <- ggplot(moran, aes(x=Year, y=Moran)) + geom_line(color="dark blue")+geom_point(color="red") + labs(subtitle = "Indonesian Regional Inflation Spatial Autocorrelation, 2012-2019",
x = "Time",
y = "Moran's I") + theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
morplot
ggsave("inflation_moran.pdf", width = 9, height = 5)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(spdep) # install.packages("spdep")
library(tidyverse)
library(summarytools)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(spdep) # install.packages("spdep")
library(tidyverse)
library(summarytools)
library(sf)
cpi <- st_read("Shape file CPI/82 cpi foodstuffs point.shp")
View(cpi)
plot(cpi)
head(cpi)
tail(cpi)
# (a) coordinates and IDs
#coords <- cpi[,c("X", "Y")]
#coords <- coordinates(coords)
IDs <- cpi$id
# (b) identify neighbors given the distance threshold
nb672km <- dnearneigh(cpi, d1=0, d2=672, row.names = IDs)
summary(nb672km)
# (c) calculate the spatial weights matrix
W.matrix <- nb2listw(nb672km)
summary(W.matrix)
#nb2listw(nb338km) #, zero.policy = TRUE)
#W.matrix <- nb2listw(nb338km,zero.policy = TRUE)
#summary(W.matrix)
cpi <- cpi %>%
mutate(avg = (X2016m10+X2016m11+X2016m12+X2017m1+X2017m2+X2017m3)/6)
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(spdep) # install.packages("spdep")
library(tidyverse)
library(summarytools)
library(xtable)
library(knitr)
library(ExPanDaR)
library(plotly)
library(REAT)
library(hdrcde)
library(pdfCluster)
library(readxl)
library(statip)
options(prompt="R> ", digits=3, scipen=999)
library(sf)
cpi <- st_read("Shape file CPI/82 cpi foodstuffs point.shp")
plot(cpi)
class(cpi)
head(cpi)
tail(cpi)
# (a) coordinates and IDs
#coords <- cpi[,c("X", "Y")]
#coords <- coordinates(coords)
IDs <- cpi$id
# (b) identify neighbors given the distance threshold
nb672km <- dnearneigh(cpi, d1=0, d2=672, row.names = IDs)
summary(nb672km)
# (c) calculate the spatial weights matrix
W.matrix <- nb2listw(nb672km)
summary(W.matrix)
#nb2listw(nb338km) #, zero.policy = TRUE)
#W.matrix <- nb2listw(nb338km,zero.policy = TRUE)
#summary(W.matrix)
cpi <- cpi %>%
mutate(avg = (X2016m10+X2016m11+X2016m12+X2017m1+X2017m2+X2017m3)/6)
View(cpi)
cpi <- cpi %>%
mutate(avg = (mo2016m10+mo2016m11+mo2016m12+mo2017m1+mo2017m2+mo2017m3)/6)
#moran.test(cpi$X2014m1,W.matrix)
#moran.test(cpi$X2015m1,W.matrix)
#moran.test(cpi$X2016m1,W.matrix)
#moran.test(cpi$X2017m1,W.matrix)
#moran.test(cpi$X2018m1,W.matrix)
#moran.test(cpi$X2019m1,W.matrix)
moran.test(cpi$mo2016m10,W.matrix)
moran.test(cpi$mo2016m12,W.matrix)
moran.test(cpi$mo2017m2,W.matrix)
moran.test(cpi$avg,W.matrix)
cpi[,10]
cpi[,11]
moran.test(cpi[,11],W.matrix)
cpi.df <- as.data.frame(cpi)
View(cpi.df)
moran.test(cpi.df[,11],W.matrix)
mor <- moran.test(cpi.df[,11],W.matrix)
mor$estimate
Moran.s_I=data.frame(var="a",moran=0)
for (i in 11:ncol(cpi.df)) {
MOR<- moran.test(cpi.df[,i],W.matrix)
lab= as.character(round(MOR$estimate[1],3))
labs = paste("I=",lab,sep=" ")
a=data.frame(var=names[i],moran=lab)
Moran.s_I<-rbind(Moran.s_I,a)
}
names=c()
names <- colnames(cpi.df)
Moran.s_I=data.frame(var="a",moran=0)
for (i in 11:ncol(cpi.df)) {
MOR<- moran.test(cpi.df[,i],W.matrix)
lab= as.character(round(MOR$estimate[1],3))
labs = paste("I=",lab,sep=" ")
a=data.frame(var=names[i],moran=lab)
Moran.s_I<-rbind(Moran.s_I,a)
}
mor <- moran.test(cpi.df[,11],W.matrix)
mor$estimate
mor <- moran.test(cpi.df[,156],W.matrix)
mor$estimate
names=c()
names <- colnames(cpi.df)
Moran.s_I=data.frame(var="a",moran=0)
for (i in 11:12) {
MOR<- moran.test(cpi.df[,i],W.matrix)
lab= as.character(round(MOR$estimate[1],3))
labs = paste("I=",lab,sep=" ")
a=data.frame(var=names[i],moran=lab)
Moran.s_I<-rbind(Moran.s_I,a)
}
Moran.s_I<-Moran.s_I[-1,]
tail(Moran.s_I)
names=c()
names <- colnames(cpi.df)
Moran.s_I=data.frame(var="a",moran=0)
for (i in 11:20) {
MOR<- moran.test(cpi.df[,i],W.matrix)
lab= as.character(round(MOR$estimate[1],3))
labs = paste("I=",lab,sep=" ")
a=data.frame(var=names[i],moran=lab)
Moran.s_I<-rbind(Moran.s_I,a)
}
Moran.s_I<-Moran.s_I[-1,]
tail(Moran.s_I)
names=c()
names <- colnames(cpi.df)
Moran.s_I=data.frame(var="a",moran=0)
for (i in 11:100) {
MOR<- moran.test(cpi.df[,i],W.matrix)
lab= as.character(round(MOR$estimate[1],3))
labs = paste("I=",lab,sep=" ")
a=data.frame(var=names[i],moran=lab)
Moran.s_I<-rbind(Moran.s_I,a)
}
Moran.s_I<-Moran.s_I[-1,]
tail(Moran.s_I)
names=c()
names <- colnames(cpi.df)
Moran.s_I=data.frame(var="a",moran=0)
for (i in 11:130) {
MOR<- moran.test(cpi.df[,i],W.matrix)
lab= as.character(round(MOR$estimate[1],3))
labs = paste("I=",lab,sep=" ")
a=data.frame(var=names[i],moran=lab)
Moran.s_I<-rbind(Moran.s_I,a)
}
Moran.s_I<-Moran.s_I[-1,]
tail(Moran.s_I)
names=c()
names <- colnames(cpi.df)
Moran.s_I=data.frame(var="a",moran=0)
for (i in 11:156) {
MOR<- moran.test(cpi.df[,i],W.matrix)
lab= as.character(round(MOR$estimate[1],3))
labs = paste("I=",lab,sep=" ")
a=data.frame(var=names[i],moran=lab)
Moran.s_I<-rbind(Moran.s_I,a)
}
names=c()
names <- colnames(cpi.df)
Moran.s_I=data.frame(var="a",moran=0)
for (i in 11:154) {
MOR<- moran.test(cpi.df[,i],W.matrix)
lab= as.character(round(MOR$estimate[1],3))
labs = paste("I=",lab,sep=" ")
a=data.frame(var=names[i],moran=lab)
Moran.s_I<-rbind(Moran.s_I,a)
}
Moran.s_I<-Moran.s_I[-1,]
tail(Moran.s_I)
mor <- moran.test(cpi.df[,156],W.matrix)
mor$p.value
names=c()
names <- colnames(cpi.df)
Moran.s_I=data.frame(var="a",moran=0, p.value=0)
for (i in 11:154) {
MOR<- moran.test(cpi.df[,i],W.matrix)
lab= (round(MOR$estimate[1],3))
pvalue = MOR$p.value
a=data.frame(var=names[i],moran=lab, p.value=pvalue)
Moran.s_I<-rbind(Moran.s_I,a)
}
Moran.s_I<-Moran.s_I[-1,]
tail(Moran.s_I)
cpi <- st_read("Shape file CPI/82 cpi foodstuffs point.shp")
View(cpi)
cpi.df <- as.data.frame(cpi)
# (a) coordinates and IDs
#coords <- cpi[,c("X", "Y")]
#coords <- coordinates(coords)
IDs <- cpi$id
# (b) identify neighbors given the distance threshold
nb672km <- dnearneigh(cpi, d1=0, d2=672, row.names = IDs)
summary(nb672km)
# (c) calculate the spatial weights matrix
W.matrix <- nb2listw(nb672km)
summary(W.matrix)
#nb2listw(nb338km) #, zero.policy = TRUE)
#W.matrix <- nb2listw(nb338km,zero.policy = TRUE)
#summary(W.matrix)
names=c()
names <- colnames(cpi.df)
Moran.s_I=data.frame(var="a",moran=0, p.value=0)
for (i in 11:137) {
MOR<- moran.test(cpi.df[,i],W.matrix)
lab= (round(MOR$estimate[1],3))
pvalue = MOR$p.value
a=data.frame(var=names[i],moran=lab, p.value=pvalue)
Moran.s_I<-rbind(Moran.s_I,a)
}
Moran.s_I<-Moran.s_I[-1,]
tail(Moran.s_I)
View(cpi.df)
